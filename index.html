<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Machine Learning Project</title>
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Hero section -->
    <section id="hero" class="text-white tm-font-big tm-parallax">
      <!-- Navigation -->
      <nav class="navbar navbar-expand-md tm-navbar" id="tmNav">
        <div class="container">
          <div class="tm-next">
              <a href="#hero" class="navbar-brand">Car Crash: Injury Prediction</a>
          </div>

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars navbar-toggler-icon"></i>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                  <a class="nav-link tm-nav-link" href="#introduction">Introduction</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link tm-nav-link" href="#work">Our Work</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link tm-nav-link" href="#reference">References</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="text-center tm-hero-text-container">
        <div class="tm-hero-text-container-inner">
            <h2 class="tm-hero-title">Anticipating Injury Severity After<br>
                Car Accidents</h2>
            <p class="tm-hero-subtitle">
              Group 20
              <br /> Dhruv Samdani, Devashru Patel, Eric Ricci, Thomas Malchodi
            </p>
        </div>
      </div>
    </section>

    <section id="introduction" class="tm-section-pad-top">
      <div class="container">
        <div class="row">
          <div class="col-lg-6">
            <img src="img/nhtsa.png" alt="Image" class="img-fluid tm-intro-img" />
          </div>
          <div class="col-lg-6">
            <div class="tm-intro-text-container">
                <h2 class="tm-text-primary mb-4 tm-section-title">Introduction</h2>
                <p class="mb-4 tm-intro-text">
                 Road incidents are one of the leading causes of death worldwide. Automobile companies constantly try to innovate their safety mechanisms to minimize the risk of such injuries and fatalities. Often these focus on mitigating damage once an accident has already occurred, such as improved air bags. However, it is also important to analyze the factors that go into causing fatal accidents such as driver behavior, environment, etc. The goal of this project is to identify the components that are reliable predictors of accidents and use them to predict injury level.
                 <br><br>
                 The data set used in this analysis comes from the Fatality Analysis Reporting System (FARS) run by the National Highway Traffic Saftey Administration (NHTSA). The data is collected on crashes that occur throughout the US and includes all crashes resulting in injury or fatality in 2018.
                </p>
            </div>
          </div>
        </div>

        <div class="row tm-section-pad-top">
          <div class="col-lg-4">
            <h4 class="text-center tm-text-primary mb-4">Data Set</h4>
            <p>
              The full data set includes a wealth of information on outcomes for each vehicle and person involved in the crash, as well as
              a number of variables relating to the crash and the emergency response.
              The below analysis is done by person and includes factors that were selected as the most likely to predict level of
              injury. Factors that occured after the crash, such as emergency response time and time of death were ignored. The
              outcome for each person has 5 possible levels of injury, "No Apparent Injury", "Possible Injury", "Suspected Minor Injury", "Suspected Serious Injury",
              and "Fatal Injury". When incomplete data was trimmed from the set the final data had 17 input features and 60,000 data points.
            </p>
          </div>

        <div class="col-lg-4 mt-5 mt-lg-0">
          <h4 class="text-center tm-text-primary mb-4">Data Formatting</h4>
          <p>
              Data formatting ...
          </p>
        </div>
        <div class="col-lg-4 mt-5 mt-lg-0">
          <h4 class="text-center tm-text-primary mb-4">Analysis Methods</h4>
          <p>
              Preliminary data analysis focused on choosing the relevant factors to remove extraneous factors and to improve runtime of model training.
              Unsupervised methods used included Mutual Information to select most relevant columns of data and PCA to reduce data set and speed up model training.
              In some models the possible outcomes were grouped into 3 outcomes, "No Injury", "Injury", and "Fatality".
              Catagorical factors were expanded with binary dummy variables to allow for inclusion of all possible factors.
              Supervised learning methods were used on the final data set to predict the injury level of people in the test data set. Methods
              tested include Decision Trees, Neural Networks, SVM, and GLM to classify each person by injury level.
          </p>
        </div>
      </div>
    </section>
    <section id="work" class="tm-section-pad-top">
      <div class="container tm-container-gallery">
        <div class="row">
          <div class="text-center col-12">
              <h2 class="tm-text-primary tm-section-title mb-4">Mutual Information Analysis</h2>
              <img src="img/normalized_mutual_info.png" alt="Mutual Info"/>
              <p>
                The above plot shows the normalized mutual information between each of the dataset features and the injury severity. The top 7 features are pictured out of
                16 tested. This shows that the 3 best features for determining the injury level are the first harmful event in a crash, the use of protection by the person,
                and whether the person was fully or partially ejected from a vehicle. This suggests that in order to prevent injury in crashes focus should be placed on
                making sure that all passengers are using appropriate protection, and in ensuring redesigning vehicles to ensure that occupants are not ejected.
              </p>
          </div>
        </div>
      </div>
    </section>
    <section id="work" class="tm-section-pad-top">
      <div class="container tm-container-gallery">
        <div class="row">
          <div class="text-center col-12">
              <h2 class="tm-text-primary tm-section-title mb-4">Confusion Matrix</h2>
              <img src="img/confusion_matrix.png" alt="Mutual Info"/>
              <p>
                The above confusion matrix shows the ability of our model to predict the correct injury level of a person involved in a crash.
              </p>
          </div>
        </div>
      </div>
    </section>

    <section id="work" class="tm-section-pad-top">
      <div class="container tm-container-gallery">
        <div class="row">
          <div class="text-center col-12">
              <h2 class="tm-text-primary tm-section-title mb-4">Influence of K Values of Model</h2>
              <img src="img/normalized_mutual_info.png" alt="Mutual Info"/>
              <p>
                The above chart shows the influence of K values on the model.
              </p>
          </div>
        </div>
      </div>
    </section>

    <section id="work" class="tm-section-pad-top">
      <div class="container tm-container-gallery">
        <div class="row">
          <div class="text-center col-12">
              <h2 class="tm-text-primary tm-section-title mb-4">Output vs Best Feature</h2>
              <img src="img/normalized_mutual_info.png" alt="Mutual Info"/>
              <p>
                The above chart shows the relationship between the output and the best feature.
              </p>
          </div>
        </div>
      </div>
    </section>
    <section id="work" class="tm-section-pad-top">
      <div class="container tm-container-gallery">
        <div class="row">
          <div class="text-center col-12">
              <h2 class="tm-text-primary tm-section-title mb-4">Output vs Worst Feature</h2>
              <img src="img/normalized_mutual_info.png" alt="Mutual Info"/>
              <p>
                The above chart shows the relationship between the output and the worst feature.
              </p>
          </div>
        </div>
      </div>
    </section>

    <section>
        <div class="container tm-container-gallery">
          <div class="row">
              <div class="tm-intro-text-container">
                  <center><h2 class="tm-text-primary tm-section-title mb-4">Conclusions</h2></center>
                  <p class="mb-4 tm-intro-text">
                      Each model was trained and tested using 5 fold cross validation to assess effectiveness at predicting injury level of a person. With 3 injury levels the highest
                      prediction accuracy was 71% using linear SVM with the [parameters].
                      Each model was tested with a number of different parameteres to determine the best set, as described below. Given the large number of factors that involved in
                      a crash and the level of randomness in how injuries occur, these levels of prediction accuracy are considered high.
                  </p>
              </div>
          </div>
      </div>
    </section>

    <section id="reference" class="tm-section-pad-top tm-parallax-2">
      <div class="container tm-container-contact">
        <div class="row">
            <div class="col-12">
                <h2 class="mb-4 tm-section-title">References</h2>
                <div class="mb-5 tm-underline">
                  <div class="tm-underline-inner"></div>
                </div>
                <p class="mb-5">
                  <ol id="list">
                    <li>Chunjiao Dong, Chunfu Shao, Juan Li, and Zhihua Xiong, “An Improved Deep Learning Model for Traffic Crash Prediction,” Journal of Advanced Transportation, vol. 2018, Article ID 3869106, 13 pages, 2018. https://doi.org/10.1155/2018/3869106.</li>
                    </br>
                    <li>F. L. Mannering and C. R. Bhat, “Analytic methods in accident research: methodological frontier and future directions,” Analytic Methods in Accident Research, vol. 1, pp. 1–22, 2014.</li>
                    </br>
                    <li>Chong, Miao & Abraham, Ajith & Paprzycki, Marcin. (2005). Traffic Accident Analysis Using Machine Learning Paradigms.. Informatica (Slovenia). 29. 89-98.</li>
                  </ol>
                </p>
            </div>
        </div>
      </div>
      <footer class="text-center small tm-footer">
          <p class="mb-0">
            Group 20
          </p>
        </footer>
    </section>
    <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/jquery.singlePageNav.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>

      function getOffSet(){
        var _offset = 450;
        var windowHeight = window.innerHeight;

        if(windowHeight > 500) {
          _offset = 400;
        }
        if(windowHeight > 680) {
          _offset = 300
        }
        if(windowHeight > 830) {
          _offset = 210;
        }

        return _offset;
      }

      function setParallaxPosition($doc, multiplier, $object){
        var offset = getOffSet();
        var from_top = $doc.scrollTop(),
          bg_css = 'center ' +(multiplier * from_top - offset) + 'px';
        $object.css({"background-position" : bg_css });
      }

      // Parallax function
      // Adapted based on https://codepen.io/roborich/pen/wpAsm
      var background_image_parallax = function($object, multiplier, forceSet){
        multiplier = typeof multiplier !== 'undefined' ? multiplier : 0.5;
        multiplier = 1 - multiplier;
        var $doc = $(document);

        if(forceSet) {
          setParallaxPosition($doc, multiplier, $object);
        } else {
          $(window).scroll(function(){
            setParallaxPosition($doc, multiplier, $object);
          });
        }
      };

      var background_image_parallax_2 = function($object, multiplier){
        multiplier = typeof multiplier !== 'undefined' ? multiplier : 0.5;
        multiplier = 1 - multiplier;
        var $doc = $(document);
        $object.css({"background-attachment" : "fixed"});
        $(window).scroll(function(){
          var firstTop = $object.offset().top,
              pos = $(window).scrollTop(),
              yPos = Math.round((multiplier * (firstTop - pos)) - 186);

          var bg_css = 'center ' + yPos + 'px';

          $object.css({"background-position" : bg_css });
        });
      };

      $(function(){
        background_image_parallax($(".tm-parallax"), 0.30, false);
        background_image_parallax_2($("#reference"), 0.80);

        // Handle window resize
        window.addEventListener('resize', function(){
          background_image_parallax($(".tm-parallax"), 0.30, true);
        }, true);

        // Detect window scroll and update navbar
        $(window).scroll(function(e){
          if($(document).scrollTop() > 120) {
            $('.tm-navbar').addClass("scroll");
          } else {
            $('.tm-navbar').removeClass("scroll");
          }
        });

        $('#tmNav a').on('click', function(){
          $('.navbar-collapse').removeClass('show');
        })

        // Scroll to corresponding section with animation
        $('#tmNav').singlePageNav();

        // Add smooth scrolling to all links
        // https://www.w3schools.com/howto/howto_css_smooth_scroll.asp
        $("a").on('click', function(event) {
          if (this.hash !== "") {
            event.preventDefault();
            var hash = this.hash;
          } // End if
        });
      });
    </script>
  </body>
</html>
